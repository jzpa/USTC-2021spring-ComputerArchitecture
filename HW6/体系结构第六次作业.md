# 体系结构第六次作业

## 第一题

假定图 5-24 的缓存内容和表 5-12 中实现方式 1 的定时参数。以下代码序列在基本协议和练习 $5.5$ 的新 MESI 协议中的总停顿周期 为多少? 假定不需要互连事务的状态转换不会导致额外的停顿周期。

- **a.** P0: read 100;  P0: write 100 <- 40
	- MSI: 100 + 15 = 115
	- MESI: 100 + 0 = 100
- **b.** P0: read 120;  P0: write 120 <- 60
	- MSI: 100 + 15 = 115
	- MESI: 100 + 15 = 115
- **c.** P0: read 100;  P0: read 120
	- MSI: 100 + 100 = 200
	- MESI: 100 + 100 = 200
- **d.** P0: read 100;  P0: write 100 <- 60
	- MSI: 100 + 100 = 200
	- MESI: 100 + 100 = 200
- **e.** P0: read 100;  P0: write 100 <- 60;  P1: write 100 <- 40
	- MSI: 100 + 15 + 40 + 10= 165
	- MESI: 100 + 0 + 40 + 10 = 150

## 第二题

目录式协议比监听式协议的可扩展性更强, 因为它们会向那些拥有块副本的节点发送显式请求和失效消息, 而监听式协议则向所有节点广播所有请求和失效消息。考虑图 5-25 所示的八处理器系统，假定所有未显示缓存拥有失效块。对于下面的每个序列，确认哪些节点 (芯片/处理器) 接收每个请求和失效消息。

- **a.** P0,0: write 100 <- 80
	- 写命中，仅涉及 P0,0 自身
- **b.** P0,0: write 108 <- 88
	- 写命中，P0,0 更新cache块，而相应的 P3,1 收到无效对应缓存块的消息
- **c.** P0,0: write 118 <- 90
	- P0,0 写缺失，先换入块，同时 P1,0 收到无效对应缓存块的消息  
- **d.** P1,0: write 128 <- 98
	- P1,0 写缺失

